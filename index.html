<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>CalcWise | Free Loan & EMI Calculator</title>
    <meta name="description" content="Use our free and easy EMI calculator from CalcWise to determine your monthly loan payments in Bangladeshi Taka (BDT).">
    <meta name="keywords" content="calcwise, emi calculator, loan calculator bdt, bdt loan, financial tools bangladesh">
    <meta name="author" content="Shakil Hossain">
    
    <!-- Favicon -->
    <link rel="icon" href="https://placehold.co/32x32/16a34a/ffffff?text=CW" type="image/png">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Custom Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light gray background */
        }
        .main-container {
            max-width: 800px;
        }
        .results-card {
            border-left: 4px solid #16a34a; /* Green accent */
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="container mx-auto p-4 md:p-8 main-container">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-green-700">CalcWise</h1>
            <p class="mt-2 text-lg text-slate-600">Your smart financial toolkit.</p>
        </header>

        <!-- Main Tool Section -->
        <main class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
            <h2 class="text-2xl font-bold mb-6">Loan / EMI Calculator</h2>
            
            <!-- Input Fields -->
            <div class="grid md:grid-cols-3 gap-6">
                <div>
                    <label for="loanAmount" class="block text-sm font-medium text-slate-700">Loan Amount (à§³)</label>
                    <input type="number" id="loanAmount" placeholder="e.g., 500000" class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-200" required>
                </div>
                <div>
                    <label for="interestRate" class="block text-sm font-medium text-slate-700">Interest Rate (% p.a.)</label>
                    <input type="number" id="interestRate" placeholder="e.g., 9.5" class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-200" required>
                </div>
                <div>
                    <label for="loanTenure" class="block text-sm font-medium text-slate-700">Loan Tenure (Years)</label>
                    <input type="number" id="loanTenure" placeholder="e.g., 5" class="mt-1 w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-200" required>
                </div>
            </div>

            <div class="mt-6 text-center">
                 <button id="calculateBtn" class="bg-green-600 text-white font-semibold px-8 py-3 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-200 shadow">
                    Calculate EMI
                </button>
            </div>

            <!-- Error Message Display -->
            <div id="errorMessage" class="text-red-600 mt-4 font-medium hidden text-center"></div>

            <!-- Results Display -->
            <div id="resultsContainer" class="mt-8 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Calculation Results</h3>
                    <button id="printBtn" class="bg-slate-200 text-slate-700 font-semibold px-4 py-2 rounded-lg hover:bg-slate-300 transition duration-200 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>
                          <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
                        </svg>
                        Print
                    </button>
                </div>
                <div class="grid md:grid-cols-2 gap-6 items-center">
                    <!-- Left Side: Chart -->
                    <div class="flex justify-center items-center">
                         <svg id="pieChart" width="200" height="200" viewBox="0 0 100 100">
                            <!-- Pie chart will be generated here -->
                         </svg>
                    </div>
                    <!-- Right Side: Text Results -->
                    <div>
                        <div class="results-card bg-slate-50 p-4 rounded-lg mb-4">
                            <p class="text-slate-600">Monthly EMI</p>
                            <p id="monthlyEmi" class="text-2xl font-bold text-green-700"></p>
                        </div>
                        <div class="results-card bg-slate-50 p-4 rounded-lg mb-4">
                            <p class="text-slate-600">Total Interest Payable</p>
                            <p id="totalInterest" class="text-2xl font-bold"></p>
                        </div>
                        <div class="results-card bg-slate-50 p-4 rounded-lg">
                            <p class="text-slate-600">Total Payment (Principal + Interest)</p>
                            <p id="totalPayment" class="text-2xl font-bold"></p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- SEO Content Section -->
        <section class="mt-12 bg-white p-8 rounded-lg shadow">
            <h2 class="text-2xl font-bold mb-4">Understanding Your Loan EMI</h2>
            <p class="text-slate-600 leading-relaxed">
                An Equated Monthly Installment (EMI) is a fixed payment amount made by a borrower to a lender at a specified date each calendar month. EMIs are used to pay off both interest and principal each month so that over a specified number of years, the loan is paid off in full. Our calculator helps you instantly determine this amount based on your loan principal, interest rate, and tenure. This allows you to make informed financial decisions before taking on a new loan.
            </p>
        </section>
        
        <!-- Footer -->
        <footer class="text-center mt-12 text-slate-500">
            <p>&copy; 2025 Shakil Hossain. All rights reserved.</p>
            <p class="text-sm mt-1">
                <a href="#" class="hover:underline">Privacy Policy</a> | <a href="#" class="hover:underline">Terms of Service</a>
            </p>
        </footer>

    </div>

    <script>
        const calculateBtn = document.getElementById('calculateBtn');
        const printBtn = document.getElementById('printBtn');
        const loanAmountInput = document.getElementById('loanAmount');
        const interestRateInput = document.getElementById('interestRate');
        const loanTenureInput = document.getElementById('loanTenure');
        const errorMessage = document.getElementById('errorMessage');
        const resultsContainer = document.getElementById('resultsContainer');
        
        const monthlyEmiEl = document.getElementById('monthlyEmi');
        const totalInterestEl = document.getElementById('totalInterest');
        const totalPaymentEl = document.getElementById('totalPayment');
        const pieChartEl = document.getElementById('pieChart');

        calculateBtn.addEventListener('click', handleCalculation);
        printBtn.addEventListener('click', printResults);

        function handleCalculation() {
            const P = parseFloat(loanAmountInput.value);
            const annualRate = parseFloat(interestRateInput.value);
            const tenureYears = parseFloat(loanTenureInput.value);

            if (isNaN(P) || P <= 0 || isNaN(annualRate) || annualRate < 0 || isNaN(tenureYears) || tenureYears <= 0) {
                showError('Please enter valid positive numbers in all fields.');
                resultsContainer.classList.add('hidden');
                return;
            }
            hideError();

            const r = annualRate / 12 / 100;
            const n = tenureYears * 12;

            let emi;
            if (r === 0) { // Handle case for 0% interest
                emi = P / n;
            } else {
                emi = P * r * (Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
            }
            
            const totalPayment = emi * n;
            const totalInterest = totalPayment - P;

            displayResults(P, emi, totalInterest, totalPayment);
        }

        function displayResults(principal, emi, interest, total) {
            const formatter = new Intl.NumberFormat('en-BD', { style: 'currency', currency: 'BDT' });
            
            monthlyEmiEl.textContent = formatter.format(emi);
            totalInterestEl.textContent = formatter.format(interest);
            totalPaymentEl.textContent = formatter.format(total);

            updatePieChart(principal, interest);
            resultsContainer.classList.remove('hidden');
        }

        function updatePieChart(principal, interest) {
            const total = principal + interest;
            const principalPercentage = (principal / total) * 100;
            
            const principalAngle = (principalPercentage / 100) * 360;
            
            const principalPath = describeArc(50, 50, 45, 0, principalAngle);
            const interestPath = describeArc(50, 50, 45, principalAngle, 360);

            pieChartEl.innerHTML = `
                <path d="${principalPath}" fill="#16a34a" />
                <path d="${interestPath}" fill="#f59e0b" />
                <circle cx="50" cy="50" r="25" fill="white" />
                <text x="50" y="48" font-family="Inter" font-size="8" text-anchor="middle" fill="#16a34a">Principal</text>
                <text x="50" y="58" font-family="Inter" font-size="6" text-anchor="middle" fill="#16a34a">${principalPercentage.toFixed(1)}%</text>
            `;
        }

        // --- NEW, RELIABLE PRINT FUNCTION ---
        function printResults() {
            const emi = monthlyEmiEl.textContent;
            const interest = totalInterestEl.textContent;
            const total = totalPaymentEl.textContent;
            const pieChartSVG = pieChartEl.outerHTML;

            const printWindowHTML = `
                <html>
                <head>
                    <title>CalcWise Loan Calculation</title>
                    <style>
                        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 2rem; }
                        h1 { color: #15803d; }
                        table { width: 100%; border-collapse: collapse; margin-top: 1rem; font-size: 1.1rem; }
                        th, td { border: 1px solid #ccc; padding: 12px; text-align: left; }
                        th { background-color: #f0fdf4; }
                        .chart-container { margin-top: 2rem; text-align: center; page-break-inside: avoid; }
                    </style>
                </head>
                <body>
                    <h1>CalcWise - Loan Calculation Result</h1>
                    <table>
                        <tr><th>Description</th><th>Amount</th></tr>
                        <tr><td>Monthly EMI</td><td>${emi}</td></tr>
                        <tr><td>Total Interest Payable</td><td>${interest}</td></tr>
                        <tr><td>Total Payment (Principal + Interest)</td><td>${total}</td></tr>
                    </table>
                    <div class="chart-container">
                        <h2>Payment Breakdown</h2>
                        ${pieChartSVG}
                    </div>
                </body>
                </html>
            `;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(printWindowHTML);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => { // Timeout ensures content is loaded before print dialog opens
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        function describeArc(x, y, radius, startAngle, endAngle) {
            const start = polarToCartesian(x, y, radius, endAngle);
            const end = polarToCartesian(x, y, radius, startAngle);
            const largeArcFlag = endAngle - startAngle <= 180 ? "0" : "1";
            const d = ["M", x, y, "L", start.x, start.y, "A", radius, radius, 0, largeArcFlag, 0, end.x, end.y, "Z"].join(" ");
            return d;
        }

        function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
            const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;
            return {
                x: centerX + (radius * Math.cos(angleInRadians)),
                y: centerY + (radius * Math.sin(angleInRadians))
            };
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        function hideError() {
            errorMessage.classList.add('hidden');
        }
    </script>
</body>
</html>